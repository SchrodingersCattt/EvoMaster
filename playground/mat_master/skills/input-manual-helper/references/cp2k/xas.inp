#Generated by Multiwfn (http://sobereva.com/multiwfn)
&GLOBAL
  PROJECT xas
  PRINT_LEVEL LOW
  RUN_TYPE ENERGY
&END GLOBAL

&FORCE_EVAL
  METHOD Quickstep
  &SUBSYS
    &CELL
      A    10.00000000     0.00000000     0.00000000
      B     0.00000000    11.51090000     0.00000000
      C     0.00000000     0.00000000    10.58895000
      PERIODIC XYZ #Direction(s) of applied PBC (geometry aspect)
    &END CELL
    &COORD
      Ox          0.00000000    0.00000000    0.11779000
      H           0.00000000    0.75545000   -0.47116000
      H           0.00000000   -0.75545000   -0.47116000
    &END COORD
    &KIND O
      ELEMENT O
      BASIS_SET DZVP-MOLOPT-SR-GTH-q6
      BASIS_SET AUX_FIT admm-dzp-q6
      POTENTIAL GTH-PBE
    &END KIND
    &KIND H
      ELEMENT H
      BASIS_SET DZVP-MOLOPT-SR-GTH-q1
      BASIS_SET AUX_FIT admm-dzp-q1
      POTENTIAL GTH-PBE
    &END KIND
    &KIND Ox       #For atom to be excited in XAS task
      ELEMENT O
      BASIS_SET pcseg-2
      BASIS_SET AUX_FIT admm-2
      POTENTIAL ALL
    &END KIND
  &END SUBSYS

  &DFT
    BASIS_SET_FILE_NAME  BASIS_MOLOPT
    BASIS_SET_FILE_NAME  BASIS_ADMM_UZH
    BASIS_SET_FILE_NAME  pcseg
    BASIS_SET_FILE_NAME  pcseg-admm
    AUTO_BASIS RI_XAS MEDIUM #Generate auxiliary basis set for XAS
    POTENTIAL_FILE_NAME  POTENTIAL
    WFN_RESTART_FILE_NAME xas-RESTART.wfn
    CHARGE    0 #Net charge
    MULTIPLICITY    1 #Spin multiplicity
    &QS
      EPS_DEFAULT 1.0E-12 #Set all EPS_xxx to values such that the energy will be correct up to this value
      EPS_PGF_ORB 1E-12 #If warning "Kohn Sham matrix not 100% occupied" occurs and meantime calculation is unstable, decrease it
      METHOD GAPW
    &END QS
    &POISSON
      PERIODIC XYZ #Direction(s) of PBC for calculating electrostatics
      PSOLVER PERIODIC #The way to solve Poisson equation
    &END POISSON
    &AUXILIARY_DENSITY_MATRIX_METHOD
      METHOD BASIS_PROJECTION #Method used for wavefunction fitting
      ADMM_PURIFICATION_METHOD NONE
    &END AUXILIARY_DENSITY_MATRIX_METHOD
    &XC
      &XC_FUNCTIONAL
        &PBE
          SCALE_X   0.55000
        &END PBE
      &END XC_FUNCTIONAL
      &HF
        FRACTION   0.45000 #HF composition
        &SCREENING
          EPS_SCHWARZ 1E-6 #The larger the value, the lower the cost and lower the accuracy
          SCREEN_ON_INITIAL_P T #Screening ERI based on initial density matrix, need to provide wavefunction restart file
        &END SCREENING
        &INTERACTION_POTENTIAL
          POTENTIAL_TYPE TRUNCATED
          CUTOFF_RADIUS  4.9751 #Cutoff radius (Angstrom) for truncated 1/r Coulomb operator
        &END INTERACTION_POTENTIAL
        &MEMORY
          MAX_MEMORY 3000 #Memory(MB) per MPI process for calculating HF exchange
          EPS_STORAGE_SCALING 0.1
        &END MEMORY
      &END HF
    &END XC
    &MGRID
      CUTOFF  400
      REL_CUTOFF  55
    &END MGRID
    &SCF
      MAX_SCF 128
      EPS_SCF 1.0E-06 #Convergence threshold of density matrix of inner SCF
      SCF_GUESS RESTART #Use wavefunction from WFN_RESTART_FILE_NAME file as initial guess
#     IGNORE_CONVERGENCE_FAILURE #Continue calculation even if SCF not converged, works for version >= 2024.1
      &DIAGONALIZATION
        ALGORITHM STANDARD #Algorithm for diagonalization
      &END DIAGONALIZATION
      &MIXING #How to mix old and new density matrices
        METHOD BROYDEN_MIXING #PULAY_MIXING is also a good alternative
        ALPHA 0.4 #Default. Mixing 40% of new density matrix with the old one
        NBROYDEN 8 #Default is 4. Number of previous steps stored for the actual mixing scheme
      &END MIXING
      &PRINT
        &RESTART #Note: Use "&RESTART OFF" can prevent generating .wfn file
          BACKUP_COPIES 0 #Maximum number of backup copies of wfn file. 0 means never
        &END RESTART
      &END PRINT
    &END SCF
    &XAS_TDP
      GRID Ox       150 200
      ENERGY_RANGE 30 #The energy range in eV for which excitations are considered
      &DONOR_STATES
        DEFINE_EXCITED BY_INDEX
        ATOM_LIST 1
        STATE_TYPES 1S #Types of orbitals that are excited
        N_SEARCH -1 #-1 means searching donor orbitals from all occupied orbitals from low to high energy
        #LOCALIZE #Perform orbital localization before searching potential donor states
      &END DONOR_STATES
      &KERNEL
        RI_REGION 2.0
        &XC_FUNCTIONAL PBE
          &PBE
            SCALE_X   0.55000
          &END PBE
        &END XC_FUNCTIONAL
        &EXACT_EXCHANGE
          FRACTION    0.45000 #HF composition
          POTENTIAL_TYPE TRUNCATED
          CUTOFF_RADIUS  4.9751 #Cutoff radius (Angstrom) for truncated 1/r Coulomb operator
        &END EXACT_EXCHANGE
      &END KERNEL
    &END XAS_TDP
  &END DFT
&END FORCE_EVAL
