#Generated by Multiwfn (http://sobereva.com/multiwfn)
&GLOBAL
  PROJECT sccs_solvation
  PRINT_LEVEL LOW
  RUN_TYPE ENERGY
&END GLOBAL

&FORCE_EVAL
  METHOD Quickstep
  &SUBSYS
    &CELL
      A    10.00000000     0.00000000     0.00000000
      B     0.00000000    11.51090000     0.00000000
      C     0.00000000     0.00000000    10.58895000
      PERIODIC XYZ #Direction(s) of applied PBC (geometry aspect)
    &END CELL
    &COORD
      O           0.00000000    0.00000000    0.11779000
      H           0.00000000    0.75545000   -0.47116000
      H           0.00000000   -0.75545000   -0.47116000
    &END COORD
    &KIND O
      ELEMENT O
      BASIS_SET DZVP-MOLOPT-SR-GTH-q6
      POTENTIAL GTH-PBE
    &END KIND
    &KIND H
      ELEMENT H
      BASIS_SET DZVP-MOLOPT-SR-GTH-q1
      POTENTIAL GTH-PBE
    &END KIND
  &END SUBSYS

  &DFT
    BASIS_SET_FILE_NAME  BASIS_MOLOPT
    POTENTIAL_FILE_NAME  POTENTIAL
#   WFN_RESTART_FILE_NAME sccs_solvation-RESTART.wfn
    CHARGE    0 #Net charge
    MULTIPLICITY    1 #Spin multiplicity
    &QS
      EPS_DEFAULT 1.0E-11 #Set all EPS_xxx to values such that the energy will be correct up to this value
    &END QS
    &POISSON
      PERIODIC XYZ #Direction(s) of PBC for calculating electrostatics
      PSOLVER PERIODIC #The way to solve Poisson equation
    &END POISSON
    &XC
      &XC_FUNCTIONAL PBE
      &END XC_FUNCTIONAL
      &VDW_POTENTIAL
        POTENTIAL_TYPE PAIR_POTENTIAL
        &PAIR_POTENTIAL
          PARAMETER_FILE_NAME dftd3.dat
          TYPE DFTD3(BJ)
          REFERENCE_FUNCTIONAL PBE
          #CALCULATE_C9_TERM T #Calculate C9-related three-body term, more accurate for large system
        &END PAIR_POTENTIAL
      &END VDW_POTENTIAL
    &END XC
    &MGRID
      CUTOFF  350
      REL_CUTOFF  50
    &END MGRID
    &SCF
      MAX_SCF 128
      EPS_SCF 5.0E-06 #Convergence threshold of density matrix of inner SCF
#     SCF_GUESS RESTART #Use wavefunction from WFN_RESTART_FILE_NAME file as initial guess
#     IGNORE_CONVERGENCE_FAILURE #Continue calculation even if SCF not converged, works for version >= 2024.1
      &DIAGONALIZATION
        ALGORITHM STANDARD #Algorithm for diagonalization
      &END DIAGONALIZATION
      &MIXING #How to mix old and new density matrices
        METHOD BROYDEN_MIXING #PULAY_MIXING is also a good alternative
        ALPHA 0.4 #Default. Mixing 40% of new density matrix with the old one
        NBROYDEN 8 #Default is 4. Number of previous steps stored for the actual mixing scheme
      &END MIXING
      &PRINT
        &RESTART #Note: Use "&RESTART OFF" can prevent generating .wfn file
          BACKUP_COPIES 0 #Maximum number of backup copies of wfn file. 0 means never
        &END RESTART
      &END PRINT
    &END SCF
    &PRINT
      @IF 1 #Printing SCCS information in each SCF iteration
      &SCCS
        &EACH
          QS_SCF 1
        &END EACH
        &POLARISATION_CHARGE_DENSITY
          &EACH
            QS_SCF 0
          &END EACH
          STRIDE 2
        &END POLARISATION_CHARGE_DENSITY
        &DIELECTRIC_FUNCTION
          &EACH
            QS_SCF 0
          &END EACH
          STRIDE 2
        &END DIELECTRIC_FUNCTION
      &END SCCS
      @ENDIF
    &END PRINT
    &SCCS
      ALPHA [mN/m] 57.2
      BETA [GPa] -0.5
      GAMMA [mN/m] 0.0
      DIELECTRIC_CONSTANT 78.36
      EPS_SCF 0.2 #SCCS is activated only if SCF iteration is converged to this threshold
      EPS_SCCS 1E-6 #Requested accuracy for convergence of polarization charge density iteration
      MAX_ITER 150 #Maximum number of polarization charge density iterations
      DERIVATIVE_METHOD CD5 #Method for calculation of numerical derivatives. Can be FFT, CD3, CD5, CD7
      &ANDREUSSI
        RHO_MIN 0.0001841
        RHO_MAX 0.0013604
      &END ANDREUSSI
    &END SCCS
  &END DFT
&END FORCE_EVAL
