#Generated by Multiwfn (http://sobereva.com/multiwfn)
&GLOBAL
  PROJECT xtb_aimd
  PRINT_LEVEL LOW
  RUN_TYPE MD
&END GLOBAL

&FORCE_EVAL
  METHOD Quickstep
  &SUBSYS
    &CELL
      A    10.00000000     0.00000000     0.00000000
      B     0.00000000    11.51090000     0.00000000
      C     0.00000000     0.00000000    10.58895000
      PERIODIC XYZ #Direction(s) of applied PBC (geometry aspect)
    &END CELL
    &COORD
      O           0.00000000    0.00000000    0.11779000
      H           0.00000000    0.75545000   -0.47116000
      H           0.00000000   -0.75545000   -0.47116000
    &END COORD
#   &VELOCITY #You can set initial atomic velocities in this section
#   &END VELOCITY
  &END SUBSYS

  &DFT
#   WFN_RESTART_FILE_NAME xtb_aimd-RESTART.wfn
    CHARGE    0 #Net charge
    MULTIPLICITY    1 #Spin multiplicity
    &QS
      EPS_DEFAULT 1.0E-10 #Set all EPS_xxx to values such that the energy will be correct up to this value
      EXTRAPOLATION ASPC #Extrapolation for wavefunction during e.g. MD. ASPC is default, PS can also be used
      EXTRAPOLATION_ORDER 3 #Order for PS or ASPC extrapolation. 3 is default
      METHOD xTB
      &xTB
        DO_EWALD T
        CHECK_ATOMIC_CHARGES F #xTB calculation often crashes without setting this to false
      &END xTB
    &END QS
    &POISSON
      PERIODIC XYZ #Direction(s) of PBC for calculating electrostatics
      PSOLVER PERIODIC #The way to solve Poisson equation
    &END POISSON
    &SCF
      MAX_SCF 25 #Maximum number of steps of inner SCF
      EPS_SCF 1.0E-05 #Convergence threshold of density matrix of inner SCF
#     SCF_GUESS RESTART #Use wavefunction from WFN_RESTART_FILE_NAME file as initial guess
#     IGNORE_CONVERGENCE_FAILURE #Continue calculation even if SCF not converged, works for version >= 2024.1
      &OT
        PRECONDITIONER FULL_SINGLE_INVERSE
        MINIMIZER DIIS #CG is worth to consider in difficult cases
        LINESEARCH 2PNT #1D line search algorithm for CG. 2PNT is default. 3PNT is more expensive but may be better. GOLD is best but very expensive
        ALGORITHM STRICT #Algorithm of OT. Can be STRICT (default) or IRAC
      &END OT
      &OUTER_SCF
        MAX_SCF 20 #Maximum number of steps of outer SCF
        EPS_SCF 1.0E-05 #Convergence threshold of outer SCF
      &END OUTER_SCF
      &PRINT
        &RESTART OFF #Do not generate wfn file to suppress meaningless I/O cost
        &END RESTART
      &END PRINT
    &END SCF
  &END DFT
&END FORCE_EVAL

&MOTION
  &MD
    ENSEMBLE NVE
    STEPS 200 #Number of steps to run
    TIMESTEP 1.0 #Step size in fs. Decrease it properly for high temperature simulation
    TEMPERATURE 298.15 #Initial and maintained temperature (K)
#   COMVEL_TOL 0 #Uncomment this can remove translation motion of center-of-mass every step
#   ANGVEL_TOL 0 #Uncomment this can remove overall rotation every step
    ANGVEL_ZERO T #Eliminate overall rotation component from initial velocity
    &PRINT
      &PROGRAM_RUN_INFO
        &EACH
          MD     1 #Output frequency of MD information, 0 means never
        &END EACH
      &END PROGRAM_RUN_INFO
    &END PRINT
  &END MD
  &PRINT
    &TRAJECTORY
      &EACH
        MD   1 #Output frequency of coordinates, 0 means never
      &END EACH
      FORMAT xyz
    &END TRAJECTORY
    &VELOCITIES
      &EACH
        MD     0 #Output frequency of velocities, 0 means never
      &END EACH
    &END VELOCITIES
    &FORCES
      &EACH
        MD     0 #Output frequency of forces, 0 means never
      &END EACH
    &END FORCES
    &RESTART
      BACKUP_COPIES 0 #Maximum number of backing up restart file, 0 means never
      &EACH
        MD  1 #Frequency of updating last restart file, 0 means never
      &END EACH
    &END RESTART
    &RESTART_HISTORY OFF 
    &END RESTART_HISTORY
  &END PRINT
&END MOTION
