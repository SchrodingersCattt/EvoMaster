#Generated by Multiwfn (http://sobereva.com/multiwfn)
&GLOBAL
  PROJECT gw_g0w0
  PRINT_LEVEL LOW
  RUN_TYPE ENERGY
&END GLOBAL

&FORCE_EVAL
  METHOD Quickstep
  &SUBSYS
    &CELL
      A     3.61500000     0.00000000     0.00000000
      B     0.00000000     3.61500000     0.00000000
      C     0.00000000     0.00000000     3.61500000
      PERIODIC XYZ #Direction(s) of applied PBC (geometry aspect)
    &END CELL
    &COORD
      Cu          0.00000000    0.00000000    0.00000000
    &END COORD
    &KIND Cu
      ELEMENT Cu
      BASIS_SET cc-QZ
      BASIS_SET RI_AUX RI_QZ
      BASIS_SET AUX_FIT admm-dzp-q11
      POTENTIAL GTH-PBE
    &END KIND
  &END SUBSYS

  &DFT
    BASIS_SET_FILE_NAME  BASIS_RI_cc-TZ
    BASIS_SET_FILE_NAME  BASIS_ADMM_UZH
    POTENTIAL_FILE_NAME  POTENTIAL
    WFN_RESTART_FILE_NAME gw_g0w0-RESTART.kp
    CHARGE    0 #Net charge
    MULTIPLICITY    2 #Spin multiplicity
    UKS
    &KPOINTS
      SCHEME MONKHORST-PACK  4  4  4
    &END KPOINTS
    &QS
      EPS_DEFAULT 1.0E-12 #Set all EPS_xxx to values such that the energy will be correct up to this value
      EPS_PGF_ORB 1E-12 #If warning "Kohn Sham matrix not 100% occupied" occurs and meantime calculation is unstable, decrease it
    &END QS
    &POISSON
      PERIODIC XYZ #Direction(s) of PBC for calculating electrostatics
      PSOLVER PERIODIC #The way to solve Poisson equation
    &END POISSON
    &AUXILIARY_DENSITY_MATRIX_METHOD
      METHOD BASIS_PROJECTION #Method used for wavefunction fitting
      ADMM_PURIFICATION_METHOD NONE
    &END AUXILIARY_DENSITY_MATRIX_METHOD
    &XC
      &XC_FUNCTIONAL
        &HYB_GGA_XC_BHANDHLYP
        &END HYB_GGA_XC_BHANDHLYP
      &END XC_FUNCTIONAL
      &HF
        FRACTION 0.5 #HF composition
        &SCREENING
          EPS_SCHWARZ 1E-7 #The larger the value, the lower the cost and lower the accuracy
          SCREEN_ON_INITIAL_P T #Screening ERI based on initial density matrix, need to provide wavefunction restart file
        &END SCREENING
        &INTERACTION_POTENTIAL
          POTENTIAL_TYPE TRUNCATED
          CUTOFF_RADIUS 6.0 #Cutoff radius (Angstrom) for truncated 1/r Coulomb operator
        &END INTERACTION_POTENTIAL
        &MEMORY
          MAX_MEMORY 3000 #Memory(MB) per MPI process for calculating HF exchange
          EPS_STORAGE_SCALING 0.1
        &END MEMORY
      &END HF
      &WF_CORRELATION
        &RI_RPA
          QUADRATURE_POINTS  100  #Number of quadrature points for the numerical integration in the GW
          &HF
            FRACTION 1.0
            &SCREENING
              EPS_SCHWARZ 1E-7
              SCREEN_ON_INITIAL_P F
            &END SCREENING
            &INTERACTION_POTENTIAL
              POTENTIAL_TYPE TRUNCATED
              CUTOFF_RADIUS  1.7985 #Cutoff radius (Angstrom) for truncated 1/r Coulomb operator
            &END INTERACTION_POTENTIAL
          &END HF
          &GW
            CORR_MOS_OCC   5  #Number of occupied MOs whose energies are to be corrected
            CORR_MOS_VIRT  5  #Number of virtual MOs whose energies are to be corrected
            EV_GW_ITER  1  #Maximum number of iterations for eigenvalue self-consistency of evGW
            SC_GW0_ITER  1   #Maximum number of iterations for GW0 self-consistency of scGW0
            UPDATE_XC_ENERGY F  #If total energy will be corrected using exact exchange and the RPA correlation energy
            RI_SIGMA_X F  #If exchange self-energy will be calculated approximatively with RI
            PERIODIC_CORRECTION F  #If periodic correction scheme will be used
            KPOINTS_SELF_ENERGY  4  4  4  #Number of k-points for self-energy
          &END GW
        &END RI_RPA
        &INTEGRALS
          &WFC_GPW
            CUTOFF      300
            REL_CUTOFF  50
            EPS_FILTER  1E-12
            EPS_GRID    1E-8
          &END WFC_GPW
        &END INTEGRALS
        MEMORY    3000 #Maximum allowed total memory usage (MB) during wavefunction-based correlation
        GROUP_SIZE  1 #Default. Also known as NUMBER_PROC
      &END WF_CORRELATION
    &END XC
    &MGRID
      CUTOFF  350
      REL_CUTOFF  50
    &END MGRID
    &SCF
      MAX_SCF 128
      EPS_SCF 1.0E-06 #Convergence threshold of density matrix of inner SCF
      SCF_GUESS RESTART #Use wavefunction from WFN_RESTART_FILE_NAME file as initial guess
#     IGNORE_CONVERGENCE_FAILURE #Continue calculation even if SCF not converged, works for version >= 2024.1
      &DIAGONALIZATION
        ALGORITHM STANDARD #Algorithm for diagonalization
      &END DIAGONALIZATION
      &MIXING #How to mix old and new density matrices
        METHOD BROYDEN_MIXING #PULAY_MIXING is also a good alternative
        ALPHA 0.4 #Default. Mixing 40% of new density matrix with the old one
        NBROYDEN 8 #Default is 4. Number of previous steps stored for the actual mixing scheme
      &END MIXING
      &PRINT
        &RESTART #Note: Use "&RESTART OFF" can prevent generating .wfn file
          BACKUP_COPIES 0 #Maximum number of backup copies of wfn file. 0 means never
        &END RESTART
      &END PRINT
    &END SCF
  &END DFT
&END FORCE_EVAL
